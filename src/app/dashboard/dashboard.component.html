<nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
        <a href="#">
        </a>
        <img src="assets/logo.png" alt="" style="width: 5%; border-radius: 100%;">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#inputModal" style="text-decoration: none;color: #fff;">
                        incluir
                      </button>
                </li>
                <li class="nav-item">
                    <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#outputModal" style="text-decoration: none;color: #fff;">
                        Distribuição
                      </button>
                </li>
                <li class="nav-item">
                    <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#editProdutos" style="text-decoration: none;color: #fff;">
                        Produtos
                      </button>
                </li>

            </ul>
            <form class="d-flex">
                <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" #search>
                <button class="btn btn-outline-warning" type="submit" (click)="filter(search.value)">Search</button>
            </form>
        </div>
    </div>
</nav>
<div class="container-fluid">
    <mat-tab-group mat-align-tabs="center" style="background-color: #fff;">
        <mat-tab label="Estoque">
            <div class="container-fluid">
                <highcharts-chart [Highcharts]="highcharts" [options]="chartOptions" style="width: 100%; height: 400px; display: block;">
                </highcharts-chart>
                <div class="mat-elevation-z8" matSort>
                    <table mat-table [dataSource]="dataSource">

                        <!--- Note that these columns can be defined in any order.
                            The actual rendered columns are set as a property on the row definition" -->

                        <!-- id Column -->
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                            <td mat-cell *matCellDef="let element"> {{element.id}} </td>
                            <td mat-footer-cell *matFooterCellDef>Total</td>
                        </ng-container>

                        <!-- Name Column -->
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                            <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                            <td mat-footer-cell *matFooterCellDef>Qtd. Produtos no estoque: {{data_estoque.length}} </td>
                        </ng-container>

                        <!-- Symbol Column -->
                        <ng-container matColumnDef="descricao">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Descrição </th>
                            <td mat-cell *matCellDef="let element"> {{element.descricao}} </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>



                        <!-- Symbol Column -->
                        <ng-container matColumnDef="unMedida">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Unidade de Medida </th>
                            <td mat-cell *matCellDef="let element"> {{element.unMedida}} </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <!-- Symbol Column -->
                        <ng-container matColumnDef="valorUn">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Unitario </th>
                            <td mat-cell *matCellDef="let element"> {{element.valorUn | currency:'BRL'}} </td>
                            <td mat-footer-cell *matFooterCellDef> </td>
                        </ng-container>

                        <!-- qtd Column -->
                        <ng-container matColumnDef="qtd">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Quantidade </th>
                            <td mat-cell *matCellDef="let element"> {{element.qtd}} </td>
                            <td mat-footer-cell *matFooterCellDef> {{getTotalQtd()}}</td>
                        </ng-container>

                        <!-- qtd Column -->
                        <ng-container matColumnDef="valorTotal">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Total </th>
                            <td mat-cell *matCellDef="let element"> {{element.valorTotal | currency:'BRL'}}</td>
                            <td mat-footer-cell *matFooterCellDef> {{getTotal() | currency:'BRL'}}</td>
                        </ng-container>

                        <ng-container matColumnDef="tipo">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Tipo </th>
                            <td mat-cell *matCellDef="let element"> {{element.tipo}}</td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <ng-container matColumnDef="fornecedor">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Fornecedor</th>
                            <td mat-cell *matCellDef="let element"> {{element.fornecedor}}</td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>



                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
                    </table>
                    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons aria-label="Select page of periodic elements">
                    </mat-paginator>
                </div>

            </div>
        </mat-tab>
        <mat-tab label="Movimentação">
            <div class="container-fluid">
                <highcharts-chart [Highcharts]="highcharts" [options]="chartOptions" style="width: 100%; height: 400px; display: block;">
                </highcharts-chart>


            </div>
        </mat-tab>
    </mat-tab-group>
</div>

<!-- inclui -->
<div class="modal fade" id="inputModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="exampleModalLabel">Entrada de Produtos</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form [formGroup]="nfGroup">
                    <div class="row">
                        <div class="col-4">
                            <mat-form-field appearance="fill">
                                <mat-label>Numero da NF</mat-label>
                                <input formControlName="nf" matInput type="number">
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field appearance="fill" class="full-width">
                                <mat-label>Emissão da NF</mat-label>
                                <input formControlName="dataNf" matInput type="date">
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field appearance="fill" class="full-width">
                                <mat-label>Fornecedor</mat-label>
                                <input formControlName="fornecedor" matInput type="text">
                            </mat-form-field>
                        </div>
                    </div>
                    <mat-panel-title>
                        Produtos
                    </mat-panel-title>
                    <mat-divider></mat-divider>
                    <mat-action-list>
                        <mat-list-item style="font-weight: bolder;">
                            <div class="col-1">ID</div>
                            <div class="col-1">Nome</div>
                            <div class="col-3">Descricao</div>
                            <div class="col-2">Unindade de Medida</div>
                            <div class="col-1">Valor Unitario</div>
                            <div class="col-3">Quantidade da entrada</div>
                        </mat-list-item>
                        <mat-divider></mat-divider>
                        <mat-list-item *ngFor="let item of itemEntrada">


                            <div class="col-1">{{item.id}}</div>
                            <div class="col-1">{{item.name}}</div>
                            <div class="col-3">{{item.descricao}}</div>
                            <div class="col-2">{{item.unMedida}}</div>
                            <div class="col-1">{{item.valorUn | currency:'BRL'}}</div>
                            <div class="col-3">
                                <mat-form-field class="example-full-width" appearance="fill">
                                    <mat-label>Qtd</mat-label>
                                    <input type="number" matInput required #qtd (keyup)="entradaQtd(item,qtd.value)">
                                </mat-form-field>
                            </div>
                            <div class="col-1">
                                <span (click)="excluirEntrada(item)">

                                    <mat-icon>remove</mat-icon>
                                </span>

                            </div>

                        </mat-list-item>
                        <button mat-list-item data-bs-target="#selectProdEntrada" data-bs-toggle="modal">Selecionar produto  <mat-icon>add</mat-icon> </button>
                    </mat-action-list>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" mat-raised-button class="btn btn-primary" (click)="incluir()" data-bs-dismiss="modal" [disabled]="!nfGroup.valid">Save changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Saida -->
<div class="modal fade" id="outputModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="exampleModalLabel">Saida de Produtos</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body girlLookAtThatBody">
                <form [formGroup]="nfGroup">
                    <div class="row">
                        <div class="col-4">
                            <mat-form-field appearance="fill">
                                <mat-label>Numero da NF</mat-label>
                                <input formControlName="nf" matInput type="number">
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field appearance="fill" class="full-width">
                                <mat-label>Emissão da NF</mat-label>
                                <input formControlName="nf" matInput type="date">
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field appearance="fill" class="full-width">
                                <mat-label>Solicitante</mat-label>
                                <input formControlName="nf" matInput type="text">
                            </mat-form-field>
                        </div>
                    </div>
                    <mat-panel-title>
                        Produtos
                    </mat-panel-title>
                    <mat-divider></mat-divider>
                    <mat-action-list>
                        <mat-list-item style="font-weight: bolder;">
                            <div class="col-1">ID</div>
                            <div class="col-1">Nome</div>
                            <div class="col-2">Descricao</div>
                            <div class="col-1">Estoque</div>
                            <div class="col-1">Unindade de Medida</div>
                            <div class="col-1">Valor Unitario</div>
                            <div class="col-3">Quantidade da Saida</div>
                        </mat-list-item>
                        <mat-divider></mat-divider>
                        <mat-list-item *ngFor="let itemS of itemSaida">
                            <div class="col-1">{{itemS.id}}</div>
                            <div class="col-1">{{itemS.name}}</div>
                            <div class="col-2">{{itemS.descricao}}</div>
                            <div class="col-1">{{itemS.qtd}}</div>
                            <div class="col-1">{{itemS.unMedida}}</div>
                            <div class="col-1">{{itemS.valorUn | currency:'BRL'}}</div>
                            <div class="col-3">
                                <mat-form-field class="example-full-width" appearance="fill">
                                    <mat-label>Qtd</mat-label>
                                    <input type="number" matInput required #qtd (keyup)="saidaQtd(itemS,qtd.value)">
                                </mat-form-field>
                            </div>
                            <div class="col-2">
                                <span (click)="excluirSaida(itemS)">

                                    <mat-icon>remove</mat-icon>
                                </span>

                            </div>
                        </mat-list-item>
                        <button mat-list-item data-bs-target="#selectprodSaida" data-bs-toggle="modal">Selecionar produto  <mat-icon>add</mat-icon> </button>
                    </mat-action-list>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" (click)="saida()" data-bs-dismiss="modal">Save changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Select Produto Saida -->
<div class="modal fade" id="selectprodSaida" aria-hidden="true" data-bs-keyboard="true" aria-labelledby="exampleModalToggleLabel2">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="exampleModalToggleLabel2">Produtos</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <mat-selection-list #itemSelectSaida>
                    <mat-list-item>
                        <div class="col-1">id</div>
                        <div class="col-3">Nome</div>
                        <div class="col-4">Descricao</div>
                        <div class="col-2">Unindade de Medida</div>
                        <div class="col-2">Valor Unitario</div>
                    </mat-list-item>
                    <mat-divider></mat-divider>
                    <mat-list-option *ngFor="let item of data_estoque" [value]="item">
                        <div class="row">
                            <div class="col-1">{{item.id}}</div>
                            <div class="col-3">{{item.name}}</div>
                            <div class="col-4">{{item.descricao}}</div>
                            <div class="col-2">{{item.unMedida}}</div>
                            <div class="col-2">{{item.valorUn | currency:'BRL'}}</div>
                        </div>
                    </mat-list-option>
                </mat-selection-list>
                <p>

                </p>
            </div>
            <div class="modal-footer justify-content-between">
                <p class="footer-info" style="text-align: left;">Qtd. de produtos selecionados: {{itemSelectSaida.selectedOptions.selected.length}} </p>
                <!-- <button mat-fab color="accent" aria-label="Example icon button with a delete icon" data-bs-target="#novoProduto" data-bs-toggle="modal" data-bs-dismiss="modal">
                    <mat-icon>add</mat-icon>
                  </button> -->
                <button mat-fab color="primary" aria-label="Example icon button with a delete icon" data-bs-dismiss="modal" (click)="selectProdSaida(itemSelectSaida.selectedOptions.selected)">
                    <mat-icon>task_alt</mat-icon>
                  </button>

            </div>
        </div>
    </div>
</div>
<!-- Select Produto Entrada-->
<div class="modal fade" id="selectProdEntrada" aria-hidden="true" aria-labelledby="selectProdEntradalabel" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="selectProdEntradalabel">Produtos</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <mat-selection-list #itensEntrada>
                    <mat-list-item>
                        <div class="col-1">id</div>
                        <div class="col-3">Nome</div>
                        <div class="col-3">Descricao</div>
                        <div class="col-2">Unindade de Medida</div>
                        <div class="col-1">Valor Unitario</div>
                    </mat-list-item>
                    <mat-divider></mat-divider>
                    <mat-list-option *ngFor="let item of data_produto" [value]="item">
                        <div class="row">
                            <div class="col-1">{{item.id}}</div>
                            <div class="col-3">{{item.name}}</div>
                            <div class="col-4">{{item.descricao}}</div>
                            <div class="col-2">{{item.unMedida}}</div>
                            <div class="col-2">{{item.valorUn | currency:'BRL'}}</div>
                        </div>
                    </mat-list-option>

                </mat-selection-list>
            </div>
            <div class="modal-footer justify-content-between">
                <p class="footer-info" style="text-align: left;">Qtd. de produtos selecionados: {{itensEntrada.selectedOptions.selected.length}} </p>
                <button mat-fab color="accent" data-bs-target="#novoProduto" data-bs-toggle="modal" data-bs-dismiss="modal">
                    <mat-icon>add</mat-icon>
                  </button>
                <button mat-fab color="primary" data-bs-dismiss="modal" (click)="selectProdEntrada(itensEntrada.selectedOptions.selected)">
                    <mat-icon>task_alt</mat-icon>
                  </button>

            </div>
        </div>
    </div>
</div>
<!-- novo Produto-->
<div class="modal fade" id="novoProduto" aria-hidden="true" aria-labelledby="novoProdutoLabel" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="novoProdutoLabel">Novo Produto</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form [formGroup]="produto">


                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Nome do Produto</mat-label>
                        <input type="text" matInput required formControlName="name">
                    </mat-form-field>


                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Descrição</mat-label>
                        <input type="text" matInput required formControlName="descricao">
                    </mat-form-field>


                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Unidade de Medida</mat-label>
                        <input type="text" matInput required formControlName="unMedida">
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Tipo</mat-label>
                        <input type="text" matInput required formControlName="tipo">
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Valor Unitario</mat-label>
                        <input type="number" matInput required formControlName="valorUn">
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Fornecedor</mat-label>
                        <input type="text" matInput required formControlName="fornecedor">
                    </mat-form-field>

                </form>

            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" data-bs-dismiss="modal" (click)=createProd() [disabled]="!produto.valid">Criar</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Produto-->
<div class="modal fade" id="editProdutos" aria-hidden="true" aria-labelledby="editProdutoslabel">
    <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="editProdutoslabel">Produtos</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <mat-selection-list #itensEntrada>
                    <mat-list-item>
                        <div class="col-1">id</div>
                        <div class="col-3">Nome</div>
                        <div class="col-4">Descricao</div>
                        <div class="col-2">Unindade de Medida</div>
                        <div class="col-2">Valor Unitario</div>
                    </mat-list-item>
                    <mat-divider></mat-divider>
                    <mat-list-item *ngFor="let item of data_produto">

                        <div class="col-1">{{item.id}}</div>
                        <div class="col-3">{{item.name}}</div>
                        <div class="col-4">{{item.descricao}}</div>
                        <div class="col-2">{{item.unMedida}}</div>
                        <div class="col-1">{{item.valorUn | currency:'BRL'}}</div>
                        <div class="col-1"> <button type="button" class="btn btn-link" data-bs-target="#editProduto" data-bs-toggle="modal" data-bs-dismiss="modal" (click)="editProd(item)"><span class="material-icons">
                            edit
                            </span></button></div>

                    </mat-list-item>

                </mat-selection-list>
            </div>
            <div class="modal-footer">

                <button mat-fab color="accent" data-bs-dismiss="modal">
                    <mat-icon>done</mat-icon>
                  </button>

            </div>
        </div>
    </div>
</div>

<!-- Edit Selected Prod -->
<div class="modal fade" id="editProduto" aria-hidden="true" aria-labelledby="editProdutoLabel" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="editProdutoLabel">Editar Produto</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form [formGroup]="produtoEdit">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>ID</mat-label>
                        <input type="text" matInput [value]="produtoEdit.value.id" disabled>
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Nome do Produto</mat-label>
                        <input type="text" matInput required formControlName="name">
                    </mat-form-field>


                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Descrição</mat-label>
                        <input type="text" matInput required formControlName="descricao">
                    </mat-form-field>


                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Unidade de Medida</mat-label>
                        <input type="text" matInput required formControlName="unMedida">
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Tipo</mat-label>
                        <input type="text" matInput required formControlName="tipo">
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Valor Unitario</mat-label>
                        <input type="number" matInput required formControlName="valorUn">
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Fornecedor</mat-label>
                        <input type="text" matInput required formControlName="fornecedor">
                    </mat-form-field>

                </form>

            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" data-bs-dismiss="modal" (click)=alteraProd(produtoEdit.value) [disabled]="!produtoEdit.valid">Alterar</button>
            </div>
        </div>
    </div>
</div>